<!-- affichage des liens -->

<div id="content_onglet" class="row collapse">
		<div class="medium-3 columns">
			    <ul class="tabs vertical"  data-active-collapse="true" id="tabs_draw" data-tabs>
					  <% i = 0 %>
				    <% @arr.each do |a| %>
							<% if i == 0 %>
								<li class="tabs-title is-active">
							<% else %>
								<li class="tabs-title">
							<% end %> <!-- end if -->
								<a href="#tab<%= i %>"><%= a.replace(a.gsub("_", ' ')) %></a>
								</li>
								<% if current_user.is_admin? %>
									<div class="edition">
										<div class="toggle_admin">
											<a data-open="renommer-folder-<%= i %> %>"><i class="fa fa-file-text" aria-hidden="true"></i></a>
											<a href="<%= folder_path(params[:desk], params[:draw], a.replace(a.gsub("_", ' '))) %>" data-method="delete" data-confirm="Souhaitez-vous supprimer le dossier <%= a.replace(a.gsub("_", ' ')) %> ? Cette action est irréversible et ne peux être annuler."><i class="fa fa-trash" aria-hidden="true"></i></a>
										</div>
									</div>
								<% end %> <!-- end if -->

							<div class="reveal" id="renommer-folder-<%= i %>" data-reveal>
							  <%= form_for :renommer_folder, method: "put",  url: URI.escape("/#{params[:desk]}/#{params[:draw]}/#{a}") do |f| %>
								<%= f.label :nom, 'Nouveau nom (25 caractères max.)' %>
								<%= f.text_field :new_name, maxlength: "25", value: a.replace(a.gsub('_', ' ')), onkeypress: "return verif(event);", autofocus: true %>
								<%= f.hidden_field :last_name, value: a.replace(a.gsub(' ', '_')) %>
								<%= f.submit :go, value: "Valider", class: "button success" %>
							  <% end %> <!-- end form -->

							  <button class="close-button" data-close aria-label="Close modal" type="button">
							    <span aria-hidden="true">&times;</span>
							  </button>
							</div>
								<% i = i + 1 %>
					  <% end %> <!-- end each -->

						<% if @arr.count != 7 && current_user.is_admin? %>
							<div class="draw_add toggle_admin">
								<a data-open="creer_dossier"><i class="fa fa-plus-circle" aria-hidden="true"></i></a>
							</div>
						<% end %>
			    </ul>
		</div> <!-- div medium-3 -->
<!-- contenu des onglets -->
		<div class="medium-9 columns">
			    <div class="tabs-content vertical" data-tabs-content="tabs_draw">
			      <% for i in 0..@arr.count %>
						<% if i == 0 %>
							<div class="tabs-panel is-active" id="tab<%= i %>">
						<% else %>
							<div class="tabs-panel" id="tab<%= i %>">
						<% end %>
						<% if current_user.is_admin? %>
							<div class="row">
								<div class="medium-2 text-center">
									<a class="toggle_admin" data-open="telech_fichier-<%= @arr[i] %>"><button type="button" class="button success tiny">Envoyer un nouveau fichier</button></a>
								</div>
								<div class="medium-2 text-center">
									<a class="toggle_admin" data-open="lien_youtube-<%= @arr[i] %>"><button type="button" class="button success tiny">Ajouter un lien YouTube</button></a>
								</div>
							</div>
						<% end %> <!-- end if -->
						<div class="row">
							<div class="medium-4">
						<!-- affichage des titres des videos et creation des liens -->
									<% if @table_videos[i] != nil %>
										<% 0.step(@table_videos[i].length-1, 2) do |j| %>
													<a class="lk_apercu" data="<%= @table_videos[i][j+1] %>" target="apercu">
														<i class="fa fa-file-video-o size-36 step" aria-hidden="true"></i>
														<%= @table_videos[i][j] %>
													</a>
													<% if current_user.is_admin? %>
														<a class="toggle_admin" href="<%= videos_path(params[:desk], params[:draw], @arr[i], @table_videos[i][j]) %>" data-method="post"><i class="fa fa-trash" aria-hidden="true"></i></a>
														<a class="toggle_admin" data-open="rename_titre-<%= i %>"><i class="fa fa-file-text" aria-hidden="true"></i></a>
													<% end %> <!-- end if -->
													<br />
													<div class="reveal" id="rename_titre-<%= i %>" data-reveal>
														<%= form_for :titre_rename, url: videos_path(params[:desk], params[:draw], @arr[i], @table_videos[i][j]) do |f| %>
														<%= f.label :nom, 'Nouveau titre ' %>
														<%= f.text_field :new_titre, autofocus: true  %>
														<%= f.submit :go, value: "Valider", class: "button success" %>
														<% end %> <!-- end form do -->

														<button class="close-button" data-close aria-label="Close modal" type="button">
															<span aria-hidden="true">&times;</span>
														</button>
													</div>
										<% end %> <!-- end for j -->
									<% end %> <!-- end if -->
						<!-- fin de affichage des titres des videos et creation des liens -->
						<!-- affichage des fichiers creation des liens -->
				        	<% if @table[i] != nil %>
					        	<% for j in 0..@table[i].length-1 %>
													<a class="lk_apercu" data="/folders/<%= params[:desk] %>/<%= params[:draw] %>/<%= @arr[i] %>/<%= @table[i][j] %>" target="apercu">
														<% if is_PDF?(@table[i][j]) %><i class="fa fa-file-pdf-o size-36 step" aria-hidden="true"></i> <% end %>
														<% if is_MP3?(@table[i][j]) %><i class="fa fa-file-audio-o size-36 step" aria-hidden="true"></i><% end %>
														<% if is_JPG?(@table[i][j]) %><i class="fa fa-file-image-o size-36 step" aria-hidden="true"></i><% end %>
														<%= @table[i][j] %>
													</a>
													<% if current_user.is_admin? %>
					        					<a class="toggle_admin" href="<%= files_path(params[:desk], params[:draw], @arr[i], @table[i][j]) %>" data-method="delete" data-confirm="Souhaitez-vous supprimer le fichier <%= @table[i][j] %> ? Cette action est irréversible et ne peux être annuler."><i class="fa fa-trash" aria-hidden="true"></i></a>
														<a class="toggle_admin" data-open="rename_file-<%= j %>"><i class="fa fa-file-text" aria-hidden="true"></i></a>
													<% end %> <!-- end if -->
													<br />
		        					<div class="reveal" id="rename_file-<%= j %>" data-reveal>
											  <%= form_for :file_rename, url:  URI.escape("/#{params[:desk]}/#{params[:draw]}/#{@arr[i]}/#{@table[i][j]}/"), method: 'put' do |f| %>
												<%= f.label :nom, 'Nouveau nom ' %>
												<%= f.text_field :new_filename, value: @table[i][j].gsub(get_extension(@table[i][j]), ""), onkeypress: "return verif(event);", autofocus: true %>
												<%= f.hidden_field :last_filename, value: @table[i][j] %>
												<%= f.submit :go, value: "Valider", class: "button success" %>
											  <% end %> <!-- end form do -->

											  <button class="close-button" data-close aria-label="Close modal" type="button">
											    <span aria-hidden="true">&times;</span>
											  </button>
											</div>

		        				<% end %> <!-- end for j -->
	        				<% end %> <!-- end if -->
							<!-- fin de affichage des fichiers creation des liens -->
							</div> <!-- fermeture de medium-4 -->
							<div class="medium-8 apercu">
									<iframe id="apercu" width="100%" height="70px" frameborder="0" allowfullscreen></iframe>
							</div>
						</div> <!-- fermeture de la row -->
					</div> <!-- fermeture tabs-panel -->
			    <% end %> <!-- end for i -->
		</div> <!-- div tabs-content -->
  </div> <!-- div medium-9 -->
</div> <!-- content-onglet -->

<div class="reveal" id="creer_dossier" data-reveal>
  <%= form_for :nouv_dossier do |f| %>
	<%= f.label :nom, 'Nom du dossier (25 caractères max.)' %>
	<%= f.text_field :nom, maxlength: "25",  onkeypress: "return verif(event);", autofocus: true  %>
	<%= f.submit :valider, value: "Valider", class: "button success tiny" %>
  <% end %>
  <button class="close-button" data-close aria-label="Close modal" type="button">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<% @arr.each do |a| %>
	<div class="reveal" id="telech_fichier-<%= a %>" data-reveal>
		<%= form_tag draw_path, method: "post", multipart: true do %>
		<%= label_tag :nom, 'Nom du dossier (pdf, jpg, mp3)' %>
		<%= file_field_tag "fichiers[]",  multiple: "true" %>
		<%= hidden_field_tag :dossier_courant, a %>
		<%= submit_tag :envoyer, value: "Télécharger", class: "button success tiny" %>
		<% end %>
		<button class="close-button" data-close aria-label="Close modal" type="button">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	<div class="reveal" id="lien_youtube-<%= a %>" data-reveal>
		<%= form_for :nouv_youtube do |f| %>
		<%= f.label :titre, 'Titre de la vidéo' %>
		<%= f.text_field :titre, maxlength: "25" %>
		<%= f.label :nom, 'Copiez le lien youtube' %>
		<%= f.text_field :nom, maxlength: "75" %>
		<%= hidden_field_tag :dossier_courant, a %>
		<%= f.submit :valider, value: "Ajouter", class: "button success tiny" %>
		<% end %>
		<button class="close-button" data-close aria-label="Close modal" type="button">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
<% end %>

 
